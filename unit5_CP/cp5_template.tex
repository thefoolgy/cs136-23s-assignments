\documentclass[10pt]{article}

%%% Doc layout
\usepackage{fullpage} 
\usepackage{booktabs}       % professional-quality tables
\usepackage{microtype}      % microtypography
\usepackage{parskip}
\usepackage{times}

%% Hyperlinks always black, no weird boxes
\usepackage[hyphens]{url}
\usepackage[colorlinks=true,allcolors=black,pdfborder={0 0 0}]{hyperref}

%%% Math typesetting
\usepackage{amsmath,amssymb}
\usepackage{pythonhighlight} 
%%% Write out problem statements in blue, solutions in black
\usepackage{xcolor}
\newcommand{\officialdirections}[1]{{\color{purple} #1}}

%%% Avoid automatic section numbers (we'll provide our own)
\setcounter{secnumdepth}{0}

%% --------------
%% Header
%% --------------
\usepackage{fancyhdr}
\fancyhf{}
\fancyhead[C]{\ifnum\value{page}=1 CS 136 - 2023s - CP5 Submission \else \fi}
\fancyfoot[C]{\thepage} % page number
\renewcommand\headrulewidth{0pt}
\pagestyle{fancy}


%% --------------
%% Begin Document
%% --------------
\begin{document}

~~\\ %% add vertical space

{\Large{\bf Student Name: TODO}}

\Large{\bf Collaboration Statement:}

Total hours spent: TODO

I discussed ideas with these individuals:
\begin{itemize}
\item TODO
\item TODO
\item $\ldots$	
\end{itemize}

I consulted the following resources:
\begin{itemize}
\item TODO
\item TODO
\item $\ldots$	
\end{itemize}
~~\\
By submitting this assignment, I affirm this is my own original work that abides by the course collaboration policy.
~~\\
~~\\
Links: 
\href{https://www.cs.tufts.edu/cs/136/2023s/cp5.html}{[CP5 instructions]} 
\href{https://www.cs.tufts.edu/cs/136/2023s/index.html#collaboration}{[collab. policy]} 

\tableofcontents

\newpage

\subsection{Forward Algorithm Implementation}
\begin{python}
def run_forward_algorithm(log_pi_K, log_A_KK, log_lik_TK):
	T, K = log_lik_TK.shape
	
	# Allocate results
	log_pdf_x_1toT = 0.0
	alpha_TK = np.zeros((T,K))

	# TODO base case update at t=0
	log_pdf_x_1toT += 0.0
	alpha_TK[0, :] = 0.0

	for t in range(1, T):
		# TODO recursive update for t=1, ... T-1
		log_pdf_x_1toT += 0.0
		alpha_TK[t, :] = 0.0

	return alpha_TK, log_pdf_x_1toT
\end{python}


\subsection{Viterbi Algorithm Implementation}
\begin{python}
def run_viterbi_algorithm(log_pi_K, log_A_KK, log_lik_TK):

	T, K = log_lik_TK.shape

	# Allocate array for storing log joint probabilities
	log_w_TK = np.zeros((T,K))
	# Allocate array for storing "backpointers"
	b_TK = -1 * np.ones((T, K), dtype=np.int32)

	# TODO base case update of log_w_TK and b_TK at t=0
	for t in range(1, T):
		# TODO base case update of log_w_TK and b_TK at t=0
		log_w_TK[t, :] = 0.0
		b_TK[t, :] = 0

	# Allocate array for storing estimated z sequence
	zhat_T = np.zeros(T, dtype=np.int32)
	# TODO Update at final timestep
	zhat_T[-1] = 0

	for t in range(T-2, -1, -1): # count from T-2, .... 1, 0 inclusive
		# TODO Update at t given zhat at t+1
		zhat_T[t] = 0

	# TODO compute joint probability of entire sequence
	hmm_log_pdf_x_and_zhat = 0.0

	return zhat_T, hmm_log_pdf_x_and_zhat
\end{python}



\end{document}
